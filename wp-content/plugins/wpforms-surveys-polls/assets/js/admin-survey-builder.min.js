!function(n){"use strict";var o,l={settings:{surveyFields:["text","textarea","select","radio","checkbox","rating","likert_scale","net_promoter_score"]},init:function(){o=this.settings,n(document).ready(l.ready),l.buildUIActions()},ready:function(){l.likertSortable()},buildUIActions:function(){n(document).on("click","#wpforms-panel-field-settings-disable_entries, #wpforms-panel-field-settings-survey_enable, #wpforms-panel-field-settings-poll_enable",l.alertEnableEntries),n(document).on("change","#wpforms-panel-field-settings-survey_enable",function(){n(this).is(":checked")?n(".wpforms-field-option-row-survey").addClass("wpforms-hidden"):n(".wpforms-field-option-row-survey").removeClass("wpforms-hidden")}),n(document).on("wpformsFieldAdd",function(e,i,t){-1<n.inArray(t,o.surveyFields)&&n("#wpforms-panel-field-settings-survey_enable").is(":checked")&&n("#wpforms-field-option-row-"+i+"-survey").addClass("wpforms-hidden")}),n(document).on("wpformsFieldAdd",function(e,i,t){"likert_scale"===t&&l.likertSortable("#wpforms-field-option-"+i+" .choices-list")}),n(document).on("click",".wpforms-field-option-likert_scale .choices-list .add",function(e){l.likertChoiceAdd(e,n(this))}),n(document).on("click",".wpforms-field-option-likert_scale .choices-list .remove",function(e){l.likertChoiceDelete(e,n(this))}),n(document).on("focusout",".wpforms-field-option-likert_scale .choices-list input",function(){var e=n(this).closest(".choices-list").data("field-id");l.likertChoiceUpdate(e)}),n(document).on("change",".wpforms-field-option-likert_scale .wpforms-field-option-row-single_row input",function(){n(this).closest(".wpforms-field-option-group-inner").find(".wpforms-field-option-row-rows .choices-list").toggleClass("wpforms-hidden"),l.likertChoiceUpdate(n(this).parent().data("field-id"))}),n(document).on("change",".wpforms-field-option-likert_scale .wpforms-field-option-row-multiple_responses input",function(){l.likertChoiceUpdate(n(this).parent().data("field-id"))}),n(document).on("change",".wpforms-field-option-likert_scale .wpforms-field-option-row-style select",function(){var e=n(this),i=e.val(),e=e.parent().data("field-id");n("#wpforms-field-"+e).find("table").removeClass("classic modern").addClass(i)}),n(document).on("change",".wpforms-field-option-net_promoter_score .wpforms-field-option-row-style select",function(){var e=n(this),i=e.val(),e=e.parent().data("field-id");n("#wpforms-field-"+e).find("table").removeClass("classic modern").addClass(i)})},alertEnableEntries:function(){var e=n(this),i=n("#wpforms-panel-field-settings-disable_entries"),t=n("#wpforms-panel-field-settings-survey_enable"),o=n("#wpforms-panel-field-settings-poll_enable"),s="";if(e.is(":checked")){if(e.is(i)){if(!t.is(":checked")&&!o.is(":checked"))return;s=wpforms_surveys_polls.alert_disable_entries}else{if(!i.is(":checked"))return;s=wpforms_surveys_polls.alert_enable_entries,e.prop("checked",!1)}n.alert({title:wpforms_builder.heads_up,content:s,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})}},likertSortable:function(e){n(e=e||".wpforms-field-option-likert_scale .choices-list").sortable({items:"li",axis:"y",delay:100,opacity:.6,handle:".move",stop:function(e,i){i=i.item.parent().data("field-id");l.likertChoiceUpdate(i)},update:function(){}})},likertChoiceAdd:function(e,i){e.preventDefault();var t=n(i),o=t.parent(),s=t.closest(".choices-list"),e=s.data("field-id"),i=s.attr("data-next-id"),t=s.data("choice-type"),o=o.clone().insertAfter(o);o.attr("data-key",i),o.find("input").val("").attr("name","fields["+e+"]["+t+"]["+i+"]"),i++,s.attr("data-next-id",i),l.likertChoiceUpdate(e)},likertChoiceDelete:function(e,i){e.preventDefault();e=n(i),i=e.closest(".choices-list");1===i.find("li").length?n.alert({title:!1,content:wpforms_builder.error_choice,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}):(e.parent().remove(),l.likertChoiceUpdate(i.data("field-id")))},likertChoiceUpdate:function(e){var t={rows:{},columns:{},colCount:0,singleRow:n("#wpforms-field-option-"+e+"-single_row").is(":checked "),singleClass:n("#wpforms-field-option-"+e+"-single_row").is(":checked ")?"single-row":"",inputType:n("#wpforms-field-option-"+e+"-multiple_responses").is(":checked ")?"checkbox":"radio",style:n("#wpforms-field-option-"+e+"-style").val(),width:0};n("#wpforms-field-option-row-"+e+"-columns .choices-list li").each(function(){var e=n(this),i=e.data("key"),e=e.find("input").val();t.columns["c"+i]={key:i,value:e},t.colCount++}),n("#wpforms-field-option-row-"+e+"-rows .choices-list li").each(function(){var e=n(this),i=e.data("key"),e=e.find("input").val();t.rows["r"+i]={key:i,value:e}}),t.width=t.singleRow?100/t.colCount:80/t.colCount;var i=wp.template("wpforms-likert-scale-preview");n("#wpforms-field-"+e).find("table").replaceWith(i(t))}};l.init()}(jQuery);